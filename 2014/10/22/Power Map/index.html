
 <!DOCTYPE HTML>
<html >
<head>
  <meta charset="UTF-8">
  <meta name="baidu_union_verify" content="d1952c66cf48912e21c18c7c581f382a">
  <meta name="360-site-verification" content="67fbcc5a67f4c65c057315b28fa0b2c8" />
<meta name="google-site-verification" content="2GzxQ0VtXwTSUdmGm6DzcmhTzM_I9QmzCb_pzpMzD88" />
  
    <title>Power Map 学习笔记 | ripeconan</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=3, minimum-scale=1">
    
    <meta name="author" content="ripeconan">
    
    <meta name="description" content="Power Map 介绍
Power Map 是微软2013年推出的 Excel2013 的插件， Power BI 的组件之一，其前身是 Geoflow。以下是 Power Map 的官方简介：

Power Map is a new 3D visualization add-in for Exc">
    
    
    
    
    <link rel="alternate" href="atom.xml" title="ripeconan" type="application/atom+xml">
    
    
    <link rel="icon" href="/img/favicon.ico">
    
    
    <link rel="stylesheet" href="/css/style.css" type="text/css">

    
    <script>
        var _hmt = _hmt || [];
        (function() {
            var hm = document.createElement("script");
            var _bdId ='63d745e76199bc2f1546dacc46fc8127';
             hm.src = "//hm.baidu.com/hm.js?" + _bdId;
             var s = document.getElementsByTagName("script")[0]; 
             s.parentNode.insertBefore(hm, s);
        })();
    </script>
     
</head>

  <body>
    <header>
      <div>
		
			<div id="textlogo">
				<h1 class="site-name"><a href="/" title="ripeconan">ripeconan</a></h1>
				<a class="blog-motto"></a>
			</div>
			<div class="navbar"><a class="navbutton navmobile" href="#" title="Menu">
			</a></div>
			<nav class="animated">
				<ul>
					<ul>
					 
						<li><a href="/">首页</a></li>
					
						<li><a href="/archives">归档</a></li>
					
					<li>
					
                                            <form class="search" action=http://zhannei.baidu.com/cse/search target="_blank">
                                            <label>Search</label>
                                        <input name="s" type="hidden" value= 1569724209730504700 ><input type="text" name="q" size="30" placeholder="Search"><br>
					
					
				</ul>
                            </nav>			
</div>

    </header>
    <div id="container">
      <div id="main" class="post" itemscope itemprop="blogPost">
	<article itemprop="articleBody"> 
		<header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2014/10/22/Power Map/" title="Power Map 学习笔记" itemprop="url">Power Map 学习笔记</a>
  </h1>
  <p class="article-author">By
    
      <a href="http://ripeconan.com" title="ripeconan">ripeconan</a>
    </p>
  <p class="article-time">
    <time datetime="2014-10-21T16:00:00.000Z" itemprop="datePublished">Oct 22 2014</time>
    Updated:<time datetime="2014-10-22T14:19:15.000Z" itemprop="dateModified">Oct 22 2014</time>
    
  </p>
</header>
	<div class="article-content">
		
		
		<div id="toc" class="toc-article">
			<strong class="toc-title">Contents</strong>
		<ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Power_Map_介绍"><span class="toc-number">1.</span> <span class="toc-text">Power Map 介绍</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#横向数据的展示（与时间无关）"><span class="toc-number">2.</span> <span class="toc-text">横向数据的展示（与时间无关）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#柱形图"><span class="toc-number">2.1.</span> <span class="toc-text">柱形图</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#气泡图"><span class="toc-number">2.2.</span> <span class="toc-text">气泡图</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#热度图"><span class="toc-number">2.3.</span> <span class="toc-text">热度图</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#将可视化更改为区域"><span class="toc-number">2.4.</span> <span class="toc-text">将可视化更改为区域</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#纵向数据的展示（按时间变化）"><span class="toc-number">3.</span> <span class="toc-text">纵向数据的展示（按时间变化）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#数据集选取"><span class="toc-number">3.1.</span> <span class="toc-text">数据集选取</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#引入时间变量来生成动画"><span class="toc-number">3.2.</span> <span class="toc-text">引入时间变量来生成动画</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#时间变量调整"><span class="toc-number">3.3.</span> <span class="toc-text">时间变量调整</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#其他的时间格式"><span class="toc-number">3.4.</span> <span class="toc-text">其他的时间格式</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#其他功能"><span class="toc-number">4.</span> <span class="toc-text">其他功能</span></a></li></ol>
		</div>
		
		<h2 id="Power_Map_介绍">Power Map 介绍</h2>
<p><strong>Power Map</strong> 是微软2013年推出的 Excel2013 的插件， <strong>Power BI</strong> 的组件之一，其前身是 <strong>Geoflow</strong>。以下是 <strong>Power Map</strong> 的官方简介：</p>
<blockquote>
<p>Power Map is a new 3D visualization add-in for Excel for mapping, exploring,<br>and interacting with geographical and temporal data, enabling people to<br>discover and share new insights.</p>
</blockquote>
<p>点击<a href="http://www.microsoft.com/en-us/download/details.aspx?id=38395" target="_blank" rel="external">下载链接</a>进入下载页面，安装较为容易，也可以参考<a href="http://jingyan.baidu.com/album/03b2f78c4f3fac5ea237ae06.html" target="_blank" rel="external">安装教程</a></p>
<hr>
<h2 id="横向数据的展示（与时间无关）">横向数据的展示（与时间无关）</h2>
<p><strong>Power Map</strong> 主要应用于具有地理位置信息的数据，其可以接受的地理位置有：  </p>
<ul>
<li>国家/地区</li>
<li>省/市/自治区</li>
<li>城市</li>
<li>经纬度</li>
<li>邮政编码 </li>
<li>…… </li>
</ul>
<p>为了方便起见，我们选用以下形式的 <em>Excel</em> 数据集来进行测试：<br><img src="/img/powermap/1.png" alt="横向数据"></p>
<p>选中数据所在单元格之后，点击 <code>插入——启动 Power Map</code>，进入地图界面：<br><img src="/img/powermap/2.png" alt="地图界面"></p>
<p>按照右下方提示，将<strong>地区</strong>变量选择为<strong>省/市/自治区</strong>，进入下一步，<br>则地图会旋转到地区变量匹配的区域：<br><img src="/img/powermap/3.png" alt="地区匹配"></p>
<p>此时进入到选择<strong>绘制变量</strong>的阶段，我们需要从已有变量中勾选出我们想要展示的变量（右上角）。对于右下角的界面，也有变化：<br><img src="/img/powermap/4.png" alt="可视化选项"></p>
<p>上面五个图形分别是： </p>
<ul>
<li>堆积柱形图(Stacked)</li>
<li>簇状柱形图(Clustered)</li>
<li>气泡图(Bubble)</li>
<li>热度地图(Heat)</li>
<li>将可视化转为区域</li>
</ul>
<p>前四个图形对应的是不同的数据展现形式，而展现的位置，是地区变量对应的一个点(例如，地区变量是省的名称，则数据就会到该省的省会城市所在地的点进行绘制)；而最后一种<strong>将可视化转为区域</strong>，则是将绘制范围从点转为面(即在该省所在面积上进行绘制)。下面将举例说明。</p>
<hr>
<h3 id="柱形图">柱形图</h3>
<p>对于柱形图的 <strong>高度、类别、时间</strong> 这三个需要填补的字段(或者称为变量)，我们应该分别填入<strong>数值型变量、分类变量、日期时间变量</strong>。在本例中，<em>变量1</em>和<em>变量2</em>是数值型变量，所以我们可以将其添加到高度中，以下是<strong>堆积柱形图</strong>和<strong>簇状柱形图</strong>的效果：<br><img src="/img/powermap/stack.png" alt="堆积柱形图"><br><img src="/img/powermap/cluster.png" alt="簇状柱形图"></p>
<p>这里面有三点值得注意：  </p>
<ol>
<li>两张地图的视角不一，这是因为我们可以使用地图的旋转和拉伸等方式来操作 <img src="/img/powermap/rotate.png" alt="旋转按钮"></li>
<li>右上角默认显示了图例，我们可以对其进行编辑，如图层名称，柱形颜色</li>
<li>我们将变量的数值展示方式由默认的<strong>求和</strong>改为了<strong>无聚合</strong>，其他还有几种，如：<ul>
<li>平均</li>
<li>计数</li>
<li>最大值</li>
<li>最小值</li>
</ul>
</li>
</ol>
<hr>
<h3 id="气泡图">气泡图</h3>
<p>对于气泡图，我们可以让气泡的大小表示单个变量的值的大小，比如：</p>
<p><img src="/img/powermap/bubble1.png" alt="单变量气泡图"></p>
<p>也可以使用气泡图展示多个变量值。此时，让不同地区的气泡维持同样大小，但气泡中不同颜色比例代表了该地区不同的值的大小关系，具体大家可以尝试一下。我们还可以在右边的设置窗口中，调节气泡的<strong>不透明度、大小、厚度</strong></p>
<p><img src="/img/powermap/bubble2.png" alt="多变量气泡图"></p>
<hr>
<h3 id="热度图">热度图</h3>
<p>热度图只能展示不同地区单变量的值，根据图例我们可以看到颜色和值的关联性，进而通过颜色的变化来了解地图上不同地区的变量值的大小。同样，使用设置窗口，我们可以更改热度图的<strong>不透明度、色阶、影响半径</strong></p>
<p><img src="/img/powermap/heat.png" alt="热度图"></p>
<hr>
<h3 id="将可视化更改为区域">将可视化更改为区域</h3>
<p>前面提到过，这个选项是将绘制范围从点转为面，按照各个地区的轮廓，在其内进行数值展示。如果对单变量的值进行绘制的话，则颜色和值的大小相关。关于此选项还有一些可以深入调试的地方，有兴趣的可以自行尝试。</p>
<p><img src="/img/powermap/region.png" alt="区域图"></p>
<hr>
<h2 id="纵向数据的展示（按时间变化）">纵向数据的展示（按时间变化）</h2>
<h3 id="数据集选取">数据集选取</h3>
<p><strong>Power Map</strong> 在横截面时间上的数据展示只是静态的，其更强大的功能在于<strong>动态可视化</strong>，即引入日期时间变量，让数据动起来。我们使用如下的数据集来说明 <strong>Power Map</strong> 对纵向数据的展示：</p>
<p><img src="/img/powermap/longitudinal.png" alt="纵向数据"></p>
<p>对该数据的说明：</p>
<ol>
<li>地区共有六个：河北、山东、山西、内蒙古、贵州、云南，后面四个地区的变量数据与前面两个相同</li>
<li>日期变量的数据格式为 <strong>日期</strong>，可以点击 <strong>右键——设置单元格格式</strong> 来修改</li>
</ol>
<hr>
<h3 id="引入时间变量来生成动画">引入时间变量来生成动画</h3>
<p>仍然将<strong>地区</strong>变量选择为<strong>省/市/自治区</strong>，进入下一步。勾选 <strong>日期</strong> 变量，由于其格式为 Excel 可识别的日期格式，所以会自动进入到右下方的 <strong>时间</strong> 选项中，注意到此时地图左上角有了时间戳：</p>
<p><img src="/img/powermap/time1.png" alt="时间设置"></p>
<p>然后勾选想要展示的变量，对于数值型变量，会直接进入到 <strong>高度</strong> 选项中。在本例中，我们勾选 <strong>变量1</strong> 和 <strong>变量2</strong>，并将展示方式设置为 <strong>簇状柱形图</strong>，对变量的操作选择 <strong>无聚合</strong></p>
<p><img src="/img/powermap/timeplay.png" alt="时间播放"></p>
<p>注意到地图下方有一个类似于播放器的播放按钮，点击即可进入播放</p>
<iframe height="498" width="510" src="http://player.youku.com/embed/XODA5MTY2MTcy" frameborder="0" allowfullscreen></iframe>

<p>可以看到，随着左上角时间的推移，我们的柱形图也在变化，这就实现了动态的数据可视化。<br>如果对播放速度不满意，我们还可以通过右上方的设置按钮进行多种播放条件进行调整：</p>
<p><img src="/img/powermap/timeconfig.png" alt="播放设置"></p>
<p>值得一提的是，<strong>效果</strong> 选项的调整，只有在点击 Excel 左上角的 <strong>播放演示</strong> 按钮后才能看到最终的效果。</p>
<hr>
<h3 id="时间变量调整">时间变量调整</h3>
<p>如果我们的数据并非以日为单位来采集的话， <strong>Power Map</strong> 该如何对其进行展示？假设我们将刚才的数据集的日期变量进行一下修改：</p>
<p><img src="/img/powermap/timechange.png" alt="时间调整"></p>
<p>此数据集仍然具有六个地区，与刚才数据集的唯一区别，就是日期变量变为<strong>以月为单位</strong>了，但日期变量的格式还是 Excel 可识别的日期格式。  </p>
<p>对此数据集进行<strong>地区选择——时间选择——高度选择</strong>这一系列流程后，我们可以对其进行播放。可以看到，时间的流逝速度加快，我们仍然在默认设置的时间内(我的默认设置是播放6秒)，观看完从2014-1-1至2014-10-1的整个动画。可以预想到，随着我们数据量的增大，当日期变量取值更加紧密的时候(比如每天都有数据点，整个数据的日期跨度为1年)，我们可能需要延长动画播放时间，才能较好的理解数据变化的模式。</p>
<hr>
<h3 id="其他的时间格式">其他的时间格式</h3>
<p>如果我们的数据是类似于传感器采集的更高频率的数据，该怎么操作？对于精确到秒的时间变量，我们只需要注意将时间变量数据格式转为 Excel 可识别的即可，如下图：</p>
<p><img src="/img/powermap/hour.png" alt="小时"></p>
<p>注意到，虽然日期变量的显示格式只是<strong>5:00:00</strong>，但是 Excel 中实际存储的是<strong>2014/1/1  5:00:00</strong>。对此数据进行动态可视化操作也是可行的，流程如上。</p>
<hr>
<h2 id="其他功能">其他功能</h2>
<p>事实上， <strong>Power Map</strong> 还有一些其他功能值得说一下：</p>
<ol>
<li><p>主题的选取。 <strong>Power Map</strong> 提供了多种地图背景供选择，如：<img src="/img/powermap/theme.png" alt="主题"></p>
</li>
<li><p>平面地图。通过点击菜单栏上的<strong>平面地图</strong>，我们可以讲地图设置为平面的。不过旋转和拉伸动作仍然可以操作，并且各种图形的绘制均无影响。<img src="/img/powermap/2d.png" alt="平面地图"></p>
</li>
<li><p>添加图层。类似于 <strong>Photoshop</strong> 的原理，我们可以在同一张背景地图上，进行不同图层的绘制，最后会将所有图层效果叠加。这使得我们可以将不同效果的图形结合起来，仅举一例：<img src="/img/powermap/layer.png" alt="图层"></p>
</li>
<li><p>形状。如果画柱形图，可以选择不同的形状，如：<img src="/img/powermap/shape.png" alt="不同形状"></p>
</li>
<li><p>还有很多功能，如二维图表、文本框等等，在此不一一赘述。</p>
</li>
</ol>
  
	</div>
		<footer class="article-footer clearfix">

  <div class="article-tags">
  
  <span></span> <a href="/tags/Excel/">Excel</a><a href="/tags/可视化/">可视化</a>
  </div>


<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/Visualization/">Visualization</a>
</div>



<div class="article-share" id="share">

  <div data-url="http://ripeconan.com/2014/10/22/Power Map/" data-title="Power Map 学习笔记 | ripeconan" data-tsina="null" class="share clearfix">
  </div>

</div>
</footer>   	       
	</article>
	
<nav class="article-nav clearfix">
 
 <div class="prev" >
 <a href="/2014/10/23/recent to do/" title="近期学习内容安排:2014年第四季度">
  <strong>PREVIOUS:</strong><br/>
  <span>
  近期学习内容安排:2014年第四季度</span>
</a>
</div>


<div class="next">
<a href="/2014/10/18/cumsum/"  title="cumsum">
 <strong>NEXT:</strong><br/> 
 <span>cumsum
</span>
</a>
</div>

</nav>

	
<section class="comment">
	<div class="ds-thread"></div>
</section>

</div>  
      <div class="openaside"><a class="navbutton" href="#" title="Show Sidebar"></a></div>

  <div id="toc" class="toc-aside">
  <strong class="toc-title">Contents</strong>
  <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Power_Map_介绍"><span class="toc-number">1.</span> <span class="toc-text">Power Map 介绍</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#横向数据的展示（与时间无关）"><span class="toc-number">2.</span> <span class="toc-text">横向数据的展示（与时间无关）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#柱形图"><span class="toc-number">2.1.</span> <span class="toc-text">柱形图</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#气泡图"><span class="toc-number">2.2.</span> <span class="toc-text">气泡图</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#热度图"><span class="toc-number">2.3.</span> <span class="toc-text">热度图</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#将可视化更改为区域"><span class="toc-number">2.4.</span> <span class="toc-text">将可视化更改为区域</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#纵向数据的展示（按时间变化）"><span class="toc-number">3.</span> <span class="toc-text">纵向数据的展示（按时间变化）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#数据集选取"><span class="toc-number">3.1.</span> <span class="toc-text">数据集选取</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#引入时间变量来生成动画"><span class="toc-number">3.2.</span> <span class="toc-text">引入时间变量来生成动画</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#时间变量调整"><span class="toc-number">3.3.</span> <span class="toc-text">时间变量调整</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#其他的时间格式"><span class="toc-number">3.4.</span> <span class="toc-text">其他的时间格式</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#其他功能"><span class="toc-number">4.</span> <span class="toc-text">其他功能</span></a></li></ol>
  </div>

<div id="asidepart">
<div class="closeaside"><a class="closebutton" href="#" title="Hide Sidebar"></a></div>
<aside class="clearfix">
<div id="authorInfo">
	
		<div class="author-logo"></div>		
	
	<div class="social-list" class="clearfix">
		
		
		
		
		
	</div>
</div>

  
<div class="categorieslist">
	<p class="asidetitle">Categories</p>
		<ul>
		
			<li><a href="/categories/Learning/" title="Learning">Learning<sup>1</sup></a></li>
		
			<li><a href="/categories/R/" title="R">R<sup>1</sup></a></li>
		
			<li><a href="/categories/Visualization/" title="Visualization">Visualization<sup>1</sup></a></li>
		
		</ul>
</div>


  
<div class="tagslist">
	<p class="asidetitle">Tags</p>
		<ul class="clearfix">
		
			<li><a href="/tags/Excel/" title="Excel">Excel<sup>1</sup></a></li>
		
			<li><a href="/tags/R函数/" title="R函数">R函数<sup>1</sup></a></li>
		
			<li><a href="/tags/To-Do/" title="To Do">To Do<sup>1</sup></a></li>
		
			<li><a href="/tags/可视化/" title="可视化">可视化<sup>1</sup></a></li>
		
		</ul>
</div>


  <div class="linkslist">
  <p class="asidetitle">Links</p>
    <ul>
      <li><a href="http://zjdian.com" target="_blank" title="zjdian">中继点</a></li>
      <li><a href="http://blog.fens.me" target="_blank" title="fens">粉丝日志</a></li>
      <li><a href="http://gengbiao.me/" target="_blank" title="coney">coney's Blog</a></li>
      <li><a href="http://tim4chan.com/" target="_blank" title="fens">Tim Chan's Blog</a></li>
    </ul>
</div>



  <div class="rsspart">
	<a href="atom.xml" target="_blank" title="rss">RSS</a>
</div>

  
  <div class="tagcloudlist">
    <p class="asidetitle">Tag Cloud</p>
    <div class="tagcloudlist clearfix">
       <a href="/tags/Excel/" style="font-size: NaNpx;">Excel</a><a href="/tags/R函数/" style="font-size: NaNpx;">R函数</a><a href="/tags/To-Do/" style="font-size: NaNpx;">To Do</a><a href="/tags/可视化/" style="font-size: NaNpx;">可视化</a>
    </div>
  </div>


</aside>
</div>
    </div>
    <footer><div id="footer" >
    
            <p class="copyright"> © 2014 
		
		<a href="http://ripeconan.com" target="_blank" title="ripeconan">ripeconan</a>
		
            && Powered by <a href="http://hexo.io" target="_blank" title="hexo">hexo</a> && Theme by <a href="http://gengbiao.me" target="_blank" title="coney">coney</a>
            </div>
</footer>
    <script src="/js/jquery-2.1.0.min.js"></script>
<script type="text/javascript">
$(document).ready(function(){ 
  $('.navbar').click(function(){
    $('header nav').toggleClass('shownav');
  });
  var myWidth = 0;
  function getSize(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
  };
  var m = $('#main'),
      a = $('#asidepart'),
      c = $('.closeaside'),
      o = $('.openaside');
  $(window).resize(function(){
    getSize(); 
    if (myWidth >= 1024) {
      $('header nav').removeClass('shownav');
    }else
    {
      m.removeClass('moveMain');
      a.css('display', 'block').removeClass('fadeOut');
      o.css('display', 'none');
      
      $('#toc.toc-aside').css('display', 'none');
        
    }
  });
  c.click(function(){
    a.addClass('fadeOut').css('display', 'none');
    o.css('display', 'block').addClass('fadeIn');
    m.addClass('moveMain');
  });
  o.click(function(){
    o.css('display', 'none').removeClass('beforeFadeIn');
    a.css('display', 'block').removeClass('fadeOut').addClass('fadeIn');      
    m.removeClass('moveMain');
  });
  $(window).scroll(function(){
    o.css("top",Math.max(80,260-$(this).scrollTop()));
  });
});
</script>

<script type="text/javascript">
$(document).ready(function(){ 
  var ai = $('.article-content>iframe'),
      ae = $('.article-content>embed'),
      t  = $('#toc'),
      h  = $('article h2')
      ah = $('article h2'),
      ta = $('#toc.toc-aside'),
      o  = $('.openaside'),
      c  = $('.closeaside');
  if(ai.length>0){
    ai.wrap('<div class="video-container" />');
  };
  if(ae.length>0){
   ae.wrap('<div class="video-container" />');
  };
  if(ah.length==0){
    t.css('display','none');
  }else{
    c.click(function(){
      ta.css('display', 'block').addClass('fadeIn');
    });
    o.click(function(){
      ta.css('display', 'none');
    });
    $(window).scroll(function(){
      ta.css("top",Math.max(140,320-$(this).scrollTop()));
    });
  };
});
</script>


<script type="text/javascript">
$(document).ready(function(){ 
  var $this = $('.share'),
      url = $this.attr('data-url'),
      encodedUrl = encodeURIComponent(url),
      title = $this.attr('data-title'),
      tsina = $this.attr('data-tsina');
  var html = [
  '<a href="#" class="overlay" id="qrcode"></a>',
  '<div class="qrcode clearfix"><span>扫描二维码分享到微信朋友圈</span><a class="qrclose" href="#share"></a><strong>Loading...Please wait</strong><img id="qrcode-pic" data-src="http://s.jiathis.com/qrcode.php?url=' + encodedUrl + '"/></div>',
  '<a href="#textlogo" class="article-back-to-top" title="Top"></a>',
  '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="article-share-facebook" target="_blank" title="Facebook"></a>',
  '<a href="#qrcode" class="article-share-qrcode" title="QRcode"></a>',
  '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="article-share-twitter" target="_blank" title="Twitter"></a>',
  '<a href="http://service.weibo.com/share/share.php?title='+title+'&url='+encodedUrl +'&ralateUid='+ tsina +'&searchPic=true&style=number' +'" class="article-share-weibo" target="_blank" title="Weibo"></a>',
  '<span title="Share to"></span>'
  ].join('');
  $this.append(html);
  $('.article-share-qrcode').click(function(){
    var imgSrc = $('#qrcode-pic').attr('data-src');
    $('#qrcode-pic').attr('src', imgSrc);
    $('#qrcode-pic').load(function(){
        $('.qrcode strong').text(' ');
    });
  });
});     
</script>


<script type="text/javascript">
  var duoshuoQuery = {short_name:"null"};
  (function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = '//static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0] 
    || document.getElementsByTagName('body')[0]).appendChild(ds);
  })();
</script> 





<script>
    
        var _bdImg = '4';
    
    window._bd_share_config={
        "common":{
            "bdSnsKey":{

            },
            "bdText":"",
            "bdMini":"2",
            "bdMiniList":[
                "qzone",
                "tsina",
                "weixin",
                "renren",
                "tqq",
                "tieba",
                "douban",
                "sqq",
                "diandian",
                "huaban",
                "youdao",
                "mail",
                "ty",
                "fbook",
                "twi",
                "linkedin",
                "copy",
                "print"
            ],
            "bdPic":"",
            "bdStyle":"0",
            "bdSize":"16"
        },
        "slide":{
            "type":"slide",
            "bdImg":_bdImg,
            "bdPos":"right",
            "bdTop":"350"
        },
        "image":{
            "viewList":[
                "weixin",
                "qzone",
                "tsina",
                "renren",
                "douban",
                "tqq"
            ],
            "viewText":"分享：",
            "viewSize":"16"
        },
        "selectShare":{
            "bdContainerClass":null,
            "bdSelectMiniList":[
                "weixin",
                "qzone",
                "tsina",
                "renren",
                "douban",
                "tqq"
            ]
        }
    };
    with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];
</script>




<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
ga('create', 'null', 'null');  
ga('send', 'pageview');
</script>


  </body>
</html>

